create table public.historial_delegaciones (
  id bigint generated by default as identity not null,
  created_at timestamp with time zone not null default now(),
  gasto_id bigint not null,
  delegador_id uuid not null,
  receptor_id uuid not null,
  decision text not null,
  motivo_rechazo text null,
  fecha_decision timestamp with time zone not null default now(),
  constraint historial_delegaciones_pkey primary key (id),
  constraint historial_delegaciones_delegador_id_fkey foreign KEY (delegador_id) references perfiles (id),
  constraint historial_delegaciones_gasto_id_fkey foreign KEY (gasto_id) references gastos (id) on delete CASCADE,
  constraint historial_delegaciones_receptor_id_fkey foreign KEY (receptor_id) references perfiles (id),
  constraint historial_delegaciones_decision_check check (
    (
      decision = any (array['aceptado'::text, 'rechazado'::text])
    )
  )
) TABLESPACE pg_default;